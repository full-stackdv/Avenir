<!--constructpro/views/admin/posts/statistics.ejs-->


<% if (post) { %>
    <div class="d-flex justify-content-between align-items-center mb-4">
        <div>
            <h2 class="h3 mb-0"><%= pageTitle %></h2>
            <a href="/admin/posts/<%= post.id %>/edit" class="small">Back to Edit Post</a> |
            <a href="/admin/posts/<%= post.id %>/preview" class="small" target="_blank">Preview Post <i class="fas fa-external-link-alt fa-xs"></i></a>
        </div>
    </div>

    <div class="row">
        <div class="col-md-6 mb-4">
            <div class="card shadow-sm">
                <div class="card-header">
                    <h5 class="mb-0"><i class="fas fa-chart-bar me-2"></i>Engagement</h5>
                </div>
                <ul class="list-group list-group-flush">
                    <li class="list-group-item d-flex justify-content-between align-items-center">
                        Total Views:
                        <span class="badge bg-primary rounded-pill fs-6"><%= post.view_count || 0 %></span>
                    </li>
                    <li class="list-group-item d-flex justify-content-between align-items-center">
                        Total Comments:
                        <span class="badge bg-info rounded-pill fs-6"><%= commentStats.total_comments || 0 %></span>
                    </li>
                    <li class="list-group-item d-flex justify-content-between align-items-center">
                        Approved Comments:
                        <span class="badge bg-success rounded-pill fs-6"><%= commentStats.approved_comments || 0 %></span>
                    </li>
                    <li class="list-group-item d-flex justify-content-between align-items-center">
                        Pending Comments:
                        <span class="badge bg-warning text-dark rounded-pill fs-6">
                            <%= commentStats.pending_comments || 0 %>
                            <% if (commentStats.pending_comments > 0) { %>
                                <a href="/admin/posts/<%= post.id %>/comments" class="ms-2 small">(Moderate)</a>
                            <% } %>
                        </span>
                    </li>
                </ul>
            </div>
        </div>

        <div class="col-md-6 mb-4">
            <div class="card shadow-sm">
                <div class="card-header">
                    <h5 class="mb-0"><i class="fas fa-info-circle me-2"></i>Post Details</h5>
                </div>
                <ul class="list-group list-group-flush">
                    <li class="list-group-item"><strong>Title:</strong> <%= post.title %></li>
                    <li class="list-group-item"><strong>Slug:</strong> <code><%= post.slug %></code></li>
                    <li class="list-group-item"><strong>Created:</strong> <%= new Date(post.created_at).toLocaleString() %></li>
                    <li class="list-group-item"><strong>Published:</strong> <%= post.published_at ? new Date(post.published_at).toLocaleString() : 'Not Yet Published' %></li>
                    <li class="list-group-item"><strong>Last Updated:</strong> <%= new Date(post.updated_at).toLocaleString() %></li>
                </ul>
            </div>
        </div>
    </div>
    <!-- placeholder for trends
    <div class="mt-4">
        <h4>View Trends (Placeholder)</h4>
        <p class="text-muted">Chart showing views over time would go here.</p>
    </div> -->

<% } else { %>
    <div class="alert alert-danger">Post information could not be loaded for statistics.</div>
    <a href="/admin/posts" class="btn btn-secondary">Back to Posts List</a>
<% } %>